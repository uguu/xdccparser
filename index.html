<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>XDCC</title>

<link rel="stylesheet" type="text/css" href="style.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script class="jsbin" src="http://datatables.net/download/build/jquery.dataTables.nightly.js"></script>

<script type="text/javascript">

$(document).ready( function () {
  var datatable = $('#packlist').dataTable( {
    'bPaginate': false,
    'oSearch' : { 'bRegex': true },
    'bInfo': false
  });
  
  $('#packlist tbody').click(function(event) {
    var tr = event.target.parentNode;
    
    var str = '/msg ' + tr.childNodes[0].childNodes[0].nodeValue + ' XDCC SEND ' + tr.childNodes[1].childNodes[0].nodeValue;

    window.prompt('Copy and paste this into your IRC client', str);
  });

  var parseIrofferXML = function(xml) {
    var botnick = xml.getElementsByTagName('currentnick')[0].childNodes[0].nodeValue;
    var packs = xml.getElementsByTagName('pack');
  
    for (i=0; i<packs.length; i++) {
      var pack = packs[i];
      var packnr = pack.getElementsByTagName('packnr')[0].childNodes[0].nodeValue;
      var packname = pack.getElementsByTagName('packname')[0].childNodes[0].nodeValue;
      var packsize = pack.getElementsByTagName('packsize')[0].childNodes[0].nodeValue;
      var packmd5 = pack.getElementsByTagName('md5sum')[0].childNodes[0].nodeValue;

      datatable.fnAddData( [botnick, packnr, packname, packsize, packmd5] );
    }
  };


  $.get('drawn-reality.packlist.xml', function(xml) {
    parseIrofferXML(xml);
  });

});

</script>
</head>
<body>
<table id="packlist">
  <thead>
    <tr>
      <th>Bot</th>
      <th>Pack Number</th>
      <th>Name</th>
      <th>Size</th>
      <th>MD5</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</body>
</html>
