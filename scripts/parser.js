// Generated by CoffeeScript 1.3.3
var bottable,datatable,infoHash,infotable,packHash,packlistArr,parseBotlist,parsePacklist,revhash;packlistArr=[],packHash={},infoHash={},revhash={},datatable=0,infotable=0,bottable=0,parsePacklist=function(){var e,t,n,r,i,s,o,u,a,f,l,c;a=packlistArr.length,u=0,t=0,i=0,$("#total").text(a),$("#msg").text("Collecting Packlists."),r=function(){if(a===i)return adjustUI(a)},o=function(e,t){var n,r,i,s,o,u;packHash[t]=[],infoHash[t]=[],revhash[e.nick]=t,u=e.packs;for(n=s=0,o=u.length;s<o;n=++s)r=u[n],i=[n+1,r.gets,r.name,r.size,r.group,e.nick],datatable.fnAddData(i,!1),packHash[t].push(i);return infoHash[t].push(["Transferred","Open Slots","Queue","Idlequeue","Curr. Bandwidth","Uptime","Nick"]),infoHash[t].push([e.transfer.total,e.slots.max-e.slots.use+"/"+e.slots.max,e.mainqueue.use+"/"+e.mainqueue.max,e.idlequeue.use+"/"+e.idlequeue.max,e.bandwidth.use,e.uptime.current,e.nick]),bottable.fnAddData([e.nick,e.packsum],!1)},n=function(e,n){return $.getJSON(e).done(function(t){onSuccess(++u);if(packHash[e]===void 0)return n(t,e)}).fail(function(){return onFailure(++t)}).always(function(){return i++,$("#processed").text(s),r()})},c=[];for(s=f=0,l=packlistArr.length;f<l;s=++f)e=packlistArr[s],c.push(n(e,o));return c},parseBotlist=function(e){var t,n,r,i,s,o,u,a,f,l,c;s=0,a=0,n=0,f=e.length,t={},$("#total").text(f),i=function(){if(f===s)return parsePacklist()},u=function(t){var n,i,o,a,l,c,h;o=0;for(a=0,c=t.length;a<c;a++){i=t[a];switch(i.type){case"packlist":packlistArr.push(i.loc);break;case"botlist":e.push(i.loc),f++,o++}}h=[];for(n=l=0;0<=o?l<o:l>o;n=0<=o?++l:--l)h.push(r(e[s+n],u));return h},r=function(e,r){return $.getJSON(e).always(function(){return s++}).done(function(n){onSuccess(++a);if(t[e]!==!0)return r(n)}).fail(function(){return onFailure(++n)}).always(function(){return $("#processed").text(s),$("#total").text(f),t[e]=!0,i()})},c=[];for(o=l=0;0<=f?l<f:l>f;o=0<=f?++l:--l)c.push(r(e[o],u));return c},$(document).ready(function(){return datatable=$("#packlisttable").dataTable({bFilter:!0,sDom:"lrt",bPaginate:!1,oSearch:{bRegex:!0},aaSorting:[[5,"asc"],[0,"asc"]]}),new FixedHeader(datatable),infotable=$("#infotable").dataTable({bFilter:!1,sDom:"lrt",bPaginate:!1,bSort:!1}),bottable=$("#bottable").dataTable({bFilter:!1,sDom:"lrt",bPaginate:!1,aaSorting:[[0,"asc"]]}),parseBotlist(["botlist.json"]),datatable.fnAdjustColumnSizing()});